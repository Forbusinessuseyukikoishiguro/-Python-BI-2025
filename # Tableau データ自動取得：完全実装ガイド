# Tableau ãƒ‡ãƒ¼ã‚¿è‡ªå‹•å–å¾—ï¼šå®Œå…¨å®Ÿè£…ã‚¬ã‚¤ãƒ‰

## ğŸ¯ ç›®çš„åˆ¥ãŠã™ã™ã‚æ‰‹æ³•

| ç›®çš„ | æ¨å¥¨æ‰‹æ³• | æ›´æ–°é »åº¦ | é›£æ˜“åº¦ |
|------|----------|----------|--------|
| ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åˆ†æ | Live Connection | ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ  | â­â­ |
| æ—¥æ¬¡ãƒãƒƒãƒæ›´æ–° | Extract Refresh + Python | æ—¥æ¬¡ã€œé€±æ¬¡ | â­â­â­ |
| è¤‡é›‘ãªETLå‡¦ç† | Tableau Prep + API | ä»»æ„ | â­â­â­â­ |
| ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ‡ãƒ¼ã‚¿ | Tableau Bridge | 15åˆ†ã€œ1æ™‚é–“ | â­â­ |
| å¤–éƒ¨ã‚·ã‚¹ãƒ†ãƒ é€£æº | REST API + Python | ä»»æ„ | â­â­â­â­â­ |

---

## ğŸš€ æ–¹æ³•1: Extract Refreshï¼ˆæœ€ã‚‚ä¸€èˆ¬çš„ï¼‰

### æ¦‚è¦
Tableauã®æ¨™æº–æ©Ÿèƒ½ã‚’ä½¿ã£ã¦ãƒ‡ãƒ¼ã‚¿æŠ½å‡ºã‚’å®šæœŸçš„ã«æ›´æ–°ã™ã‚‹æ–¹æ³•ã€‚

### å®Ÿè£…æ‰‹é †

#### Step 1: Extractä½œæˆ
```python
# ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹æº–å‚™ç”¨Pythonã‚¹ã‚¯ãƒªãƒ—ãƒˆ
import pandas as pd
import sqlite3
from datetime import datetime

def prepare_data_for_tableau():
    """Tableauç”¨ã®ãƒ‡ãƒ¼ã‚¿ã‚’æº–å‚™ã™ã‚‹"""
    
    # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰æœ€æ–°ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
    conn = sqlite3.connect('business_data.db')
    
    query = """
    SELECT 
        date,
        product_id,
        sales_amount,
        customer_id,
        region
    FROM sales_data 
    WHERE date >= date('now', '-30 days')
    """
    
    df = pd.read_sql_query(query, conn)
    
    # ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°
    df['date'] = pd.to_datetime(df['date'])
    df = df.dropna()
    
    # Tableauç”¨CSVã¨ã—ã¦ä¿å­˜
    timestamp = datetime.now().strftime('%Y%m%d_%H%M%S')
    filename = f'tableau_data_{timestamp}.csv'
    df.to_csv(filename, index=False)
    
    conn.close()
    return filename

if __name__ == "__main__":
    filename = prepare_data_for_tableau()
    print(f"Data prepared: {filename}")
```

#### Step 2: Tableauå´è¨­å®š
1. **ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ä½œæˆ**: CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¥ç¶š
2. **Extractä½œæˆ**: ã€Œãƒ‡ãƒ¼ã‚¿ã€â†’ã€ŒæŠ½å‡ºã€â†’ã€Œä½œæˆã€
3. **æ›´æ–°ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«è¨­å®š**: Tableau Server/Onlineã§è¨­å®š

---

## âš¡ æ–¹æ³•2: REST APIè‡ªå‹•åŒ–

### Pythonå®Ÿè£…ä¾‹

```python
import requests
import pandas as pd
import json
import os
from datetime import datetime

class TableauDataUpdater:
    def __init__(self, server_url, username, password, site_id=''):
        self.server_url = server_url
        self.username = username
        self.password = password
        self.site_id = site_id
        self.auth_token = None
        self.site_id_actual = None
        
    def sign_in(self):
        """Tableau Serverã«ã‚µã‚¤ãƒ³ã‚¤ãƒ³"""
        url = f"{self.server_url}/api/3.15/auth/signin"
        
        # ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£
        payload = {
            'credentials': {
                'name': self.username,
                'password': self.password,
                'site': {
                    'contentUrl': self.site_id
                }
            }
        }
        
        headers = {
            'Content-Type': 'application/json',
            'Accept': 'application/json'
        }
        
        response = requests.post(url, json=payload, headers=headers)
        
        if response.status_code == 200:
            result = response.json()
            self.auth_token = result['credentials']['token']
            self.site_id_actual = result['credentials']['site']['id']
            print("âœ… ã‚µã‚¤ãƒ³ã‚¤ãƒ³æˆåŠŸ")
            return True
        else:
            print(f"âŒ ã‚µã‚¤ãƒ³ã‚¤ãƒ³å¤±æ•—: {response.status_code}")
            return False
    
    def upload_data_source(self, file_path, datasource_name):
        """ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰"""
        if not self.auth_token:
            print("âŒ å…ˆã«ã‚µã‚¤ãƒ³ã‚¤ãƒ³ã—ã¦ãã ã•ã„")
            return False
            
        url = f"{self.server_url}/api/3.15/sites/{self.site_id_actual}/datasources"
        
        headers = {
            'X-Tableau-Auth': self.auth_token
        }
        
        # ãƒãƒ«ãƒãƒ‘ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿
        files = {
            'tableau_datasource': open(file_path, 'rb'),
            'datasource_name': (None, datasource_name),
            'overwrite': (None, 'true')
        }
        
        response = requests.post(url, headers=headers, files=files)
        
        if response.status_code == 201:
            print(f"âœ… ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ '{datasource_name}' ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æˆåŠŸ")
            return True
        else:
            print(f"âŒ ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å¤±æ•—: {response.status_code}")
            print(response.text)
            return False
    
    def refresh_extract(self, datasource_id):
        """Extract ã‚’å¼·åˆ¶æ›´æ–°"""
        url = f"{self.server_url}/api/3.15/sites/{self.site_id_actual}/datasources/{datasource_id}/refresh"
        
        headers = {
            'X-Tableau-Auth': self.auth_token,
            'Content-Type': 'application/json'
        }
        
        response = requests.post(url, headers=headers)
        
        if response.status_code == 202:
            print("âœ… Extractæ›´æ–°é–‹å§‹")
            return True
        else:
            print(f"âŒ Extractæ›´æ–°å¤±æ•—: {response.status_code}")
            return False
    
    def sign_out(self):
        """ã‚µã‚¤ãƒ³ã‚¢ã‚¦ãƒˆ"""
        if self.auth_token:
            url = f"{self.server_url}/api/3.15/auth/signout"
            headers = {'X-Tableau-Auth': self.auth_token}
            requests.post(url, headers=headers)
            print("âœ… ã‚µã‚¤ãƒ³ã‚¢ã‚¦ãƒˆå®Œäº†")

# ä½¿ç”¨ä¾‹
def automated_data_update():
    """è‡ªå‹•ãƒ‡ãƒ¼ã‚¿æ›´æ–°ã®å®Ÿè¡Œ"""
    
    # 1. æœ€æ–°ãƒ‡ãƒ¼ã‚¿ã®æº–å‚™
    print("ğŸ“Š æœ€æ–°ãƒ‡ãƒ¼ã‚¿ã‚’æº–å‚™ä¸­...")
    df = fetch_latest_data()  # ç‹¬è‡ªã®ãƒ‡ãƒ¼ã‚¿å–å¾—é–¢æ•°
    
    # 2. ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°
    df_cleaned = clean_data_for_tableau(df)
    
    # 3. ãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜
    timestamp = datetime.now().strftime('%Y%m%d_%H%M%S')
    filename = f'auto_update_{timestamp}.csv'
    df_cleaned.to_csv(filename, index=False)
    
    # 4. Tableau Serverã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
    updater = TableauDataUpdater(
        server_url='https://your-tableau-server.com',
        username='your_username',
        password='your_password',
        site_id='your_site'
    )
    
    if updater.sign_in():
        updater.upload_data_source(filename, 'AutoUpdatedData')
        updater.sign_out()
    
    # 5. ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤
    os.remove(filename)
    print("ğŸ‰ è‡ªå‹•æ›´æ–°å®Œäº†")

if __name__ == "__main__":
    automated_data_update()
```

---

## ğŸ”„ æ–¹æ³•3: Tableau Prepè‡ªå‹•åŒ–

### Tableau Prep Flow + Python

```python
import subprocess
import json
import os

class TableauPrepAutomation:
    def __init__(self, prep_path, flow_path):
        self.prep_path = prep_path  # Tableau Prepå®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹
        self.flow_path = flow_path  # .tflãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹
        
    def run_flow(self, output_path=None):
        """Prep Flowã‚’å®Ÿè¡Œ"""
        
        cmd = [
            self.prep_path,
            '-t', self.flow_path  # flowãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®š
        ]
        
        if output_path:
            cmd.extend(['-o', output_path])
        
        try:
            result = subprocess.run(cmd, capture_output=True, text=True)
            
            if result.returncode == 0:
                print("âœ… Tableau Prep Flowå®Ÿè¡ŒæˆåŠŸ")
                return True
            else:
                print(f"âŒ Flowå®Ÿè¡Œå¤±æ•—: {result.stderr}")
                return False
                
        except Exception as e:
            print(f"âŒ ã‚¨ãƒ©ãƒ¼: {e}")
            return False

# ãƒãƒƒãƒã‚¹ã‚¯ãƒªãƒ—ãƒˆä¾‹ï¼ˆWindowsï¼‰
def create_batch_script():
    """Windowsç”¨ãƒãƒƒãƒã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆ"""
    
    script_content = '''
@echo off
echo "Tableauè‡ªå‹•æ›´æ–°é–‹å§‹..."

:: Pythonç’°å¢ƒã®æ´»æ€§åŒ–
call C:\\path\\to\\venv\\Scripts\\activate.bat

:: ãƒ‡ãƒ¼ã‚¿æº–å‚™ã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œ
python prepare_data.py

:: Tableau Prep Flowå®Ÿè¡Œ
"C:\\Program Files\\Tableau\\Tableau Prep Builder 2023.1\\bin\\tableau-prep-cli.cmd" -t "C:\\path\\to\\your_flow.tfl"

:: å®Œäº†é€šçŸ¥
echo "è‡ªå‹•æ›´æ–°å®Œäº†"
pause
'''
    
    with open('tableau_auto_update.bat', 'w') as f:
        f.write(script_content)
    
    print("âœ… ãƒãƒƒãƒã‚¹ã‚¯ãƒªãƒ—ãƒˆä½œæˆå®Œäº†")

# å®Ÿè¡Œä¾‹
prep_automation = TableauPrepAutomation(
    prep_path="C:\\Program Files\\Tableau\\Tableau Prep Builder 2023.1\\bin\\tableau-prep-cli.cmd",
    flow_path="C:\\path\\to\\your_flow.tfl"
)

prep_automation.run_flow()
```

---

## ğŸŒ æ–¹æ³•4: Web Data Connector (WDC)

### ã‚«ã‚¹ã‚¿ãƒ WDCä½œæˆ

```html
<!DOCTYPE html>
<html>
<head>
    <title>Custom WDC</title>
    <meta charset="utf-8">
    <script src="https://connectors.tableau.com/libs/tableauwdc-2.3.latest.js"></script>
</head>
<body>
    <div id="submitButton">
        <button type="button" onclick="getData()">Get Data</button>
    </div>

    <script>
    (function() {
        var myConnector = tableau.makeConnector();

        myConnector.getSchema = function(schemaCallback) {
            var cols = [{
                id: "date",
                dataType: tableau.dataTypeEnum.date
            }, {
                id: "sales",
                alias: "Sales Amount",
                dataType: tableau.dataTypeEnum.float
            }, {
                id: "product",
                alias: "Product Name",
                dataType: tableau.dataTypeEnum.string
            }];

            var tableSchema = {
                id: "salesData",
                alias: "Sales Data",
                columns: cols
            };

            schemaCallback([tableSchema]);
        };

        myConnector.getData = function(table, doneCallback) {
            // APIã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
            fetch('https://api.your-company.com/sales-data')
                .then(response => response.json())
                .then(data => {
                    var tableData = [];
                    
                    data.forEach(function(item) {
                        tableData.push({
                            "date": item.date,
                            "sales": item.sales_amount,
                            "product": item.product_name
                        });
                    });
                    
                    table.appendRows(tableData);
                    doneCallback();
                })
                .catch(error => {
                    tableau.abortWithError("ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚¨ãƒ©ãƒ¼: " + error);
                });
        };

        tableau.registerConnector(myConnector);

        function getData() {
            tableau.connectionName = "Custom Sales Data";
            tableau.submit();
        }

        // è‡ªå‹•å®Ÿè¡Œï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
        window.onload = function() {
            if (tableau.phase === tableau.phaseEnum.gatherDataPhase) {
                getData();
            }
        };
    })();
    </script>
</body>
</html>
```

---

## â° æ–¹æ³•5: ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«å®Ÿè¡Œè¨­å®š

### Windowsã‚¿ã‚¹ã‚¯ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©

```python
# schedule_setup.py
import schedule
import time
import logging
from datetime import datetime

# ãƒ­ã‚°è¨­å®š
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(levelname)s - %(message)s',
    handlers=[
        logging.FileHandler('tableau_automation.log'),
        logging.StreamHandler()
    ]
)

def daily_data_update():
    """æ—¥æ¬¡ãƒ‡ãƒ¼ã‚¿æ›´æ–°ã‚¿ã‚¹ã‚¯"""
    try:
        logging.info("æ—¥æ¬¡ãƒ‡ãƒ¼ã‚¿æ›´æ–°é–‹å§‹")
        
        # ãƒ‡ãƒ¼ã‚¿æº–å‚™
        prepare_data_for_tableau()
        
        # Tableauæ›´æ–°
        update_tableau_extracts()
        
        logging.info("æ—¥æ¬¡ãƒ‡ãƒ¼ã‚¿æ›´æ–°å®Œäº†")
        
    except Exception as e:
        logging.error(f"ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ: {e}")

def hourly_refresh():
    """æ™‚é–“ã”ã¨ã®ç°¡æ˜“æ›´æ–°"""
    try:
        logging.info("æ™‚é–“æ›´æ–°é–‹å§‹")
        refresh_live_connections()
        logging.info("æ™‚é–“æ›´æ–°å®Œäº†")
        
    except Exception as e:
        logging.error(f"æ™‚é–“æ›´æ–°ã‚¨ãƒ©ãƒ¼: {e}")

# ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«è¨­å®š
schedule.every().day.at("06:00").do(daily_data_update)
schedule.every().hour.at(":00").do(hourly_refresh)

# å®Ÿè¡Œãƒ«ãƒ¼ãƒ—
def run_scheduler():
    logging.info("ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ãƒ¼é–‹å§‹")
    
    while True:
        schedule.run_pending()
        time.sleep(60)  # 1åˆ†ã”ã¨ã«ãƒã‚§ãƒƒã‚¯

if __name__ == "__main__":
    run_scheduler()
```

### Linux Cronè¨­å®š

```bash
# crontab -e ã§ç·¨é›†

# æ¯æ—¥6æ™‚ã«ãƒ‡ãƒ¼ã‚¿æ›´æ–°
0 6 * * * /usr/bin/python3 /path/to/tableau_update.py

# 1æ™‚é–“ã”ã¨ã«Extractæ›´æ–°
0 * * * * /usr/bin/python3 /path/to/hourly_refresh.py

# å¹³æ—¥ã®ã¿å®Ÿè¡Œï¼ˆæœˆã€œé‡‘ï¼‰
0 8 * * 1-5 /usr/bin/python3 /path/to/weekday_update.py
```

---

## ğŸ”§ å®Ÿç”¨çš„ãªçµ±åˆã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³

### å®Œå…¨è‡ªå‹•åŒ–ã‚¯ãƒ©ã‚¹

```python
import pandas as pd
import requests
import sqlite3
import schedule
import time
import smtplib
from email.mime.text import MIMEText
from datetime import datetime, timedelta
import logging

class TableauAutoUpdater:
    def __init__(self, config):
        self.config = config
        self.setup_logging()
        
    def setup_logging(self):
        """ãƒ­ã‚°è¨­å®š"""
        logging.basicConfig(
            level=logging.INFO,
            format='%(asctime)s - %(levelname)s - %(message)s',
            handlers=[
                logging.FileHandler('tableau_auto.log'),
                logging.StreamHandler()
            ]
        )
        self.logger = logging
    
    def extract_data_from_source(self):
        """ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã‹ã‚‰æŠ½å‡º"""
        try:
            if self.config['source_type'] == 'database':
                return self._extract_from_database()
            elif self.config['source_type'] == 'api':
                return self._extract_from_api()
            elif self.config['source_type'] == 'file':
                return self._extract_from_file()
        except Exception as e:
            self.logger.error(f"ãƒ‡ãƒ¼ã‚¿æŠ½å‡ºã‚¨ãƒ©ãƒ¼: {e}")
            return None
    
    def _extract_from_database(self):
        """ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰æŠ½å‡º"""
        conn = sqlite3.connect(self.config['db_path'])
        df = pd.read_sql_query(self.config['query'], conn)
        conn.close()
        return df
    
    def _extract_from_api(self):
        """APIã‹ã‚‰æŠ½å‡º"""
        response = requests.get(
            self.config['api_url'],
            headers=self.config.get('api_headers', {}),
            params=self.config.get('api_params', {})
        )
        return pd.DataFrame(response.json())
    
    def transform_data(self, df):
        """ãƒ‡ãƒ¼ã‚¿å¤‰æ›"""
        if df is None:
            return None
            
        # åŸºæœ¬çš„ãªã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°
        df = df.dropna()
        df = df.drop_duplicates()
        
        # æ—¥ä»˜å¤‰æ›
        if 'date' in df.columns:
            df['date'] = pd.to_datetime(df['date'])
        
        # ã‚«ã‚¹ã‚¿ãƒ å¤‰æ›
        if 'transformations' in self.config:
            for transform in self.config['transformations']:
                df = self._apply_transformation(df, transform)
        
        return df
    
    def update_tableau(self, df):
        """Tableauã‚’æ›´æ–°"""
        if df is None:
            return False
            
        try:
            # CSVä¿å­˜
            filename = f"tableau_data_{datetime.now().strftime('%Y%m%d_%H%M%S')}.csv"
            df.to_csv(filename, index=False)
            
            # Tableau Server APIçµŒç”±ã§æ›´æ–°
            updater = TableauDataUpdater(
                self.config['tableau_server'],
                self.config['tableau_username'],
                self.config['tableau_password']
            )
            
            if updater.sign_in():
                success = updater.upload_data_source(filename, self.config['datasource_name'])
                updater.sign_out()
                return success
                
        except Exception as e:
            self.logger.error(f"Tableauæ›´æ–°ã‚¨ãƒ©ãƒ¼: {e}")
            return False
    
    def send_notification(self, success, message=""):
        """çµæœé€šçŸ¥"""
        if not self.config.get('send_notifications', False):
            return
            
        status = "æˆåŠŸ" if success else "å¤±æ•—"
        subject = f"Tableauè‡ªå‹•æ›´æ–° {status}"
        
        msg = MIMEText(f"""
        Tableauè‡ªå‹•æ›´æ–°ãŒå®Œäº†ã—ã¾ã—ãŸã€‚
        
        ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: {status}
        æ™‚åˆ»: {datetime.now()}
        ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸: {message}
        """)
        
        msg['Subject'] = subject
        msg['From'] = self.config['email_from']
        msg['To'] = self.config['email_to']
        
        try:
            with smtplib.SMTP(self.config['smtp_server']) as server:
                server.send_message(msg)
        except Exception as e:
            self.logger.error(f"é€šçŸ¥é€ä¿¡ã‚¨ãƒ©ãƒ¼: {e}")
    
    def run_update_cycle(self):
        """æ›´æ–°ã‚µã‚¤ã‚¯ãƒ«å®Ÿè¡Œ"""
        self.logger.info("è‡ªå‹•æ›´æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹")
        
        # ãƒ‡ãƒ¼ã‚¿æŠ½å‡º
        df = self.extract_data_from_source()
        if df is None:
            self.send_notification(False, "ãƒ‡ãƒ¼ã‚¿æŠ½å‡ºå¤±æ•—")
            return
        
        # ãƒ‡ãƒ¼ã‚¿å¤‰æ›
        df_transformed = self.transform_data(df)
        
        # Tableauæ›´æ–°
        success = self.update_tableau(df_transformed)
        
        # é€šçŸ¥
        message = f"å‡¦ç†è¡Œæ•°: {len(df_transformed)}" if success else "æ›´æ–°å¤±æ•—"
        self.send_notification(success, message)
        
        self.logger.info(f"æ›´æ–°ã‚µã‚¤ã‚¯ãƒ«å®Œäº†: {'æˆåŠŸ' if success else 'å¤±æ•—'}")

# è¨­å®šä¾‹
config = {
    'source_type': 'database',
    'db_path': 'business.db',
    'query': 'SELECT * FROM sales WHERE date >= date("now", "-7 days")',
    'tableau_server': 'https://your-tableau-server.com',
    'tableau_username': 'username',
    'tableau_password': 'password',
    'datasource_name': 'AutoSalesData',
    'send_notifications': True,
    'email_from': 'system@company.com',
    'email_to': 'analyst@company.com',
    'smtp_server': 'smtp.company.com'
}

# å®Ÿè¡Œ
if __name__ == "__main__":
    updater = TableauAutoUpdater(config)
    
    # æ—¥æ¬¡å®Ÿè¡Œã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«
    schedule.every().day.at("06:00").do(updater.run_update_cycle)
    
    while True:
        schedule.run_pending()
        time.sleep(3600)  # 1æ™‚é–“ã”ã¨ã«ãƒã‚§ãƒƒã‚¯
```

---

## ğŸš€ ãŠã™ã™ã‚ã®å®Ÿè£…æˆ¦ç•¥

### ãƒ•ã‚§ãƒ¼ã‚º1: åŸºæœ¬è‡ªå‹•åŒ–
1. **Extract Refresh**ã‹ã‚‰é–‹å§‹
2. **Python + CSV**ã§ã®ç®€å•ãªæ›´æ–°
3. **æ‰‹å‹•ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«**ã§ã®å‹•ä½œç¢ºèª

### ãƒ•ã‚§ãƒ¼ã‚º2: é«˜åº¦è‡ªå‹•åŒ–
1. **REST API**å°å…¥
2. **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**å¼·åŒ–
3. **ç›£è¦–ãƒ»ã‚¢ãƒ©ãƒ¼ãƒˆ**æ©Ÿèƒ½è¿½åŠ 

### ãƒ•ã‚§ãƒ¼ã‚º3: ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºå¯¾å¿œ
1. **Tableau Prep**çµ±åˆ
2. **è¤‡æ•°ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹**å¯¾å¿œ
3. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–**

ã“ã®æ®µéšçš„ãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒã§ã€å®‰å®šã—ãŸTableauè‡ªå‹•åŒ–ã‚·ã‚¹ãƒ†ãƒ ã‚’æ§‹ç¯‰ã§ãã¾ã™ï¼
